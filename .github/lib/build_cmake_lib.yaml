name: 'Build CMake Library'
description: 'Clones and builds a CMake library'
inputs:
  name:
    description: 'Library name (folder name)'
    required: true
  url:
    description: 'Git repository URL'
    required: true
  mode:
    description: 'Build mode (Debug/Release)'
    required: true
    default: 'Release'
  install-prefix:
    description: 'Install prefix'
    required: false
    default: '${{ github.workspace }}/deps'

runs:
  using: "composite"
  steps:
    - name: Build ${{ inputs.name }}
      shell: bash
      run: |
        git clone --depth 1 ${{ inputs.url }} ../${{ inputs.name }} --recurse
        cmake -S ../${{ inputs.name }} -B ../${{ inputs.name }}/build -G Ninja -DCMAKE_BUILD_TYPE=${{ inputs.mode }}
        cmake --build ../${{ inputs.name }}/build --config ${{ inputs.mode }}
        cmake --install ../${{ inputs.name }}/build --prefix "${{ inputs.install-prefix }}"